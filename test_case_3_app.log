2025-06-02 21:59:50,732 - app - INFO - Flask application logger explicitly configured for checklist debugging. Log level set to DEBUG for testing.
INFO:app:Flask application logger explicitly configured for checklist debugging. Log level set to DEBUG for testing.
2025-06-02 21:59:50,733 - app - INFO - Ensured database directory exists: /app/instance
INFO:app:Ensured database directory exists: /app/instance
2025-06-02 21:59:50,733 - app - INFO - Ensured report directory exists: /app/reports
INFO:app:Ensured report directory exists: /app/reports
2025-06-02 21:59:50,733 - app - INFO - Ensured drawing directory exists: static/drawings
INFO:app:Ensured drawing directory exists: static/drawings
2025-06-02 21:59:50,733 - app - INFO - Using SQLALCHEMY_DATABASE_URI: sqlite:////app/instance/myapp.db
INFO:app:Using SQLALCHEMY_DATABASE_URI: sqlite:////app/instance/myapp.db
2025-06-02 21:59:50,733 - app - INFO - Ensured upload directory exists: static/images
INFO:app:Ensured upload directory exists: static/images
2025-06-02 21:59:50,770 - app - INFO - Checking database tables...
INFO:app:Checking database tables...
2025-06-02 21:59:50,773 - app - INFO - Existing tables: ['attachments', 'checklist_items', 'checklists', 'comments', 'defect_markers', 'defects', 'drawings', 'project_access', 'projects', 'template_items', 'templates', 'users']
INFO:app:Existing tables: ['attachments', 'checklist_items', 'checklists', 'comments', 'defect_markers', 'defects', 'drawings', 'project_access', 'projects', 'template_items', 'templates', 'users']
2025-06-02 21:59:50,773 - app - INFO - Required tables: ['users', 'project_access', 'projects', 'defects', 'comments', 'attachments', 'templates', 'template_items', 'checklists', 'checklist_items', 'drawings', 'defect_markers']
INFO:app:Required tables: ['users', 'project_access', 'projects', 'defects', 'comments', 'attachments', 'templates', 'template_items', 'checklists', 'checklist_items', 'drawings', 'defect_markers']
2025-06-02 21:59:50,773 - app - INFO - All required tables already exist, skipping creation.
INFO:app:All required tables already exist, skipping creation.
 * Serving Flask app 'app.py'
 * Debug mode: off
INFO:werkzeug:[31m[1mWARNING: This is a development server. Do not use it in a production deployment. Use a production WSGI server instead.[0m
 * Running on http://127.0.0.1:5000
INFO:werkzeug:[33mPress CTRL+C to quit[0m
2025-06-02 21:59:58,047 - app - INFO - --- Starting Test Case 3 for PDF Report ---
INFO:app:--- Starting Test Case 3 for PDF Report ---
2025-06-02 21:59:58,047 - app - INFO - Setting up data for Test Case 3 - Simulated PDF Failure
INFO:app:Setting up data for Test Case 3 - Simulated PDF Failure
2025-06-02 21:59:58,048 - app - INFO - Generating PDF report for project ID: 999 with filter: All
INFO:app:Generating PDF report for project ID: 999 with filter: All
2025-06-02 21:59:58,048 - app - INFO - Using provided project_obj for testing: Test Project for Case 3
INFO:app:Using provided project_obj for testing: Test Project for Case 3
2025-06-02 21:59:58,048 - app - INFO - Found 1 open items and 0 closed items for the report.
INFO:app:Found 1 open items and 0 closed items for the report.
2025-06-02 21:59:58,057 - app - DEBUG - Processing marked drawing for defect 3: static/drawings/dummy_drawing.pdf
DEBUG:app:Processing marked drawing for defect 3: static/drawings/dummy_drawing.pdf
2025-06-02 21:59:58,057 - app - DEBUG - Attempting to convert PDF page to image: static/drawings/dummy_drawing.pdf
DEBUG:app:Attempting to convert PDF page to image: static/drawings/dummy_drawing.pdf
2025-06-02 21:59:58,057 - app - ERROR - PDF to image conversion failed for static/drawings/dummy_drawing.pdf (defect 3): Simulated PDF conversion error for testing TC3
Traceback (most recent call last):
  File "/app/app.py", line 1647, in add_defect_to_pdf
    raise Exception("Simulated PDF conversion error for testing TC3")
Exception: Simulated PDF conversion error for testing TC3
ERROR:app:PDF to image conversion failed for static/drawings/dummy_drawing.pdf (defect 3): Simulated PDF conversion error for testing TC3
Traceback (most recent call last):
  File "/app/app.py", line 1647, in add_defect_to_pdf
    raise Exception("Simulated PDF conversion error for testing TC3")
Exception: Simulated PDF conversion error for testing TC3
2025-06-02 21:59:58,059 - app - DEBUG - Processing/Falling back to regular attachments for defect 3
DEBUG:app:Processing/Falling back to regular attachments for defect 3
2025-06-02 21:59:58,059 - app - DEBUG - Attachments for defect 3: [MockAttachment(id=102, file_path='images/another_dummy_photo.png', thumbnail_path='images/thumb_another_dummy_photo.png')]
DEBUG:app:Attachments for defect 3: [MockAttachment(id=102, file_path='images/another_dummy_photo.png', thumbnail_path='images/thumb_another_dummy_photo.png')]
2025-06-02 21:59:58,059 - app - DEBUG - Processing attachment item for defect 3: images/another_dummy_photo.png
DEBUG:app:Processing attachment item for defect 3: images/another_dummy_photo.png
2025-06-02 21:59:58,059 - app - DEBUG - Attempting to add image to PDF: static/images/another_dummy_photo.png
DEBUG:app:Attempting to add image to PDF: static/images/another_dummy_photo.png
2025-06-02 21:59:58,071 - app - DEBUG - Successfully added image static/images/another_dummy_photo.png to PDF.
DEBUG:app:Successfully added image static/images/another_dummy_photo.png to PDF.
2025-06-02 21:59:58,077 - app - INFO - Saving PDF report to: /app/reports/report_project_Test_Project_for_Case_3_20250602_215958.pdf
INFO:app:Saving PDF report to: /app/reports/report_project_Test_Project_for_Case_3_20250602_215958.pdf
2025-06-02 21:59:58,078 - app - INFO - Sending PDF for project 999 with headers: {'Content-Disposition': 'attachment; filename=report_project_Test_Project_for_Case_3_20250602_215958.pdf', 'Content-Type': 'application/pdf', 'Content-Length': '3252', 'Last-Modified': 'Mon, 02 Jun 2025 21:59:58 GMT', 'Cache-Control': 'no-store, no-cache, must-revalidate, max-age=0', 'ETag': '"1748901598.075013-3252-3463518477"', 'Date': 'Mon, 02 Jun 2025 21:59:58 GMT', 'Pragma': 'no-cache', 'Expires': '0'}
INFO:app:Sending PDF for project 999 with headers: {'Content-Disposition': 'attachment; filename=report_project_Test_Project_for_Case_3_20250602_215958.pdf', 'Content-Type': 'application/pdf', 'Content-Length': '3252', 'Last-Modified': 'Mon, 02 Jun 2025 21:59:58 GMT', 'Cache-Control': 'no-store, no-cache, must-revalidate, max-age=0', 'ETag': '"1748901598.075013-3252-3463518477"', 'Date': 'Mon, 02 Jun 2025 21:59:58 GMT', 'Pragma': 'no-cache', 'Expires': '0'}
2025-06-02 21:59:58,078 - app - INFO - --- Finished Test Case 3 ---
INFO:app:--- Finished Test Case 3 ---
INFO:werkzeug:127.0.0.1 - - [02/Jun/2025 21:59:58] "GET /test_report_case/3 HTTP/1.1" 200 -
